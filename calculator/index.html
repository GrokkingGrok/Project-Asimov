<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RoboTorq Calculator – Robonomics</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body{font-family:Arial,Helvetica,sans-serif;background:#0e0e10;color:#e0e0e0;margin:2rem}
  .card{background:#1a1a1d;border-radius:8px;padding:1.5rem;margin-bottom:1.5rem;box-shadow:0 2px 8px rgba(0,0,0,.5)}
  h1{margin-top:0;color:#00ff9d}
  label{display:block;margin-top:1rem;font-weight:600}
  input[type=number]{width:100%;padding:.5rem;background:#2c2c2f;border:1px solid #444;border-radius:4px;color:#fff}
  table{width:100%;margin-top:1rem;border-collapse:collapse}
  th,td{border:1px solid #444;padding:.5rem;text-align:left}
  th{background:#00ff9d;color:#000}
  button{margin-top:1rem;padding:.6rem 1.2rem;background:#00ff9d;color:#000;border:none;border-radius:4px;cursor:pointer}
  button:hover{background:#00cc7a}
  #export{display:none}
</style>
</head>
<body>

<div class="card">
  <h1>RoboTorq Calculator</h1>
  <p>Enter your robot spec, work duration and expected markup (torq_gamble). The calculator follows the <strong>Robonomics white-paper</strong> equations.</p>

  <label for="ttp">TokenTorqPotential (TTP) – TokenTorq / hour</label>
  <input id="ttp" type="number" step="0.1" value="5.0">

  <label for="hours">Duration (hours)</label>
  <input id="hours" type="number" step="1" value="100">

  <label for="gamble">torq_gamble (markup multiplier)</label>
  <input id="gamble" type="number" step="0.1" min="1" value="3.0">

  <label for="items">Items produced (optional – for price-per-item)</label>
  <input id="items" type="number" step="1" placeholder="e.g. 400">

  <button onclick="calc()">Calculate</button>
</div>

<div class="card" id="results" style="display:none">
  <h2>Results</h2>
  <table id="resultTable">
    <tr><th>Metric</th><th>Value</th><th>Unit</th></tr>
  </table>
  <button id="exportBtn" onclick="exportCSV()">Export as CSV</button>
</div>

<script>
function calc() {
  const ttp   = parseFloat(document.getElementById('ttp').value)   || 0;
  const hrs   = parseFloat(document.getElementById('hours').value) || 0;
  const gamble= parseFloat(document.getElementById('gamble').value)|| 1;
  const items = parseFloat(document.getElementById('items').value)|| null;

  // Core equations (white-paper §11)
  const RoboTorq_in   = ttp * 3.6 * hrs;                     // RT
  const MintingNeeded = RoboTorq_in * (gamble - 1);         // RT
  const Total_Value   = RoboTorq_in + MintingNeeded;        // RT

  const rows = [
    ['RoboTorq_in (input cost)', RoboTorq_in.toFixed(2), 'RT'],
    ['MintingNeeded (new value)', MintingNeeded.toFixed(2), 'RT'],
    ['Total RoboTorq_out', Total_Value.toFixed(2), 'RT'],
  ];

  if (items) {
    const pricePerItem = Total_Value / items;
    rows.push(['Price per item (break-even)', pricePerItem.toFixed(4), 'RT']);
    rows.push(['Items produced', items, 'units']);
  }

  // Population estimate – you can replace with a real number later
  const worldPop = 8_000_000_000;
  const perCitizen = Total_Value / worldPop;
  rows.push(['Universal dividend per citizen', perCitizen.toExponential(3), 'RT']);

  // Show table
  const tbl = document.getElementById('resultTable');
  tbl.innerHTML = '<tr><th>Metric</th><th>Value</th><th>Unit</th></tr>';
  rows.forEach(r => {
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${r[0]}</td><td>${r[1]}</td><td>${r[2]}</td>`;
    tbl.appendChild(tr);
  });

  document.getElementById('results').style.display = 'block';
  document.getElementById('exportBtn').style.display = 'inline-block';
  window.resultData = rows; // for CSV export
}

function exportCSV() {
  let csv = 'Metric,Value,Unit\n';
  window.resultData.forEach(r => csv += `"${r[0]}",${r[1]},${r[2]}\n`);
  const blob = new Blob([csv], {type: 'text/csv'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'roboTorq_calc.csv';
  a.click();
}
</script>

</body>
</html>
