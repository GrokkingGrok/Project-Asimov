<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Watts > Wall Street: Dividend Projector</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  :root {
    --bg: #0e0e10;
    --card-bg: #1a1a1d;
    --text: #e0e0e0;
    --input-bg: #2c2c2f;
    --border: #444;
    --primary: #00ff9d;
    --primary-hover: #00cc7a;
    --preset-bg: #ff6b6b;
    --preset-hover: #ff5252;
    --live-bg: #4ecdc4;
    --highlight: #00ff9d;
    --table-header: #00ff9d;
    --table-header-text: #000;
  }
  [data-theme="light"] {
    --bg: #f5f5f5;
    --card-bg: #ffffff;
    --text: #1a1a1d;
    --input-bg: #f0f0f0;
    --border: #ccc;
    --primary: #00cc7a;
    --primary-hover: #00b368;
    --preset-bg: #ff5252;
    --preset-hover: #ff3333;
    --live-bg: #4ecdc4;
    --highlight: #00b368;
    --table-header: #00cc7a;
    --table-header-text: #fff;
  }
  body {
    font-family: Arial, Helvetica, sans-serif;
    background: var(--bg);
    color: var(--text);
    margin: 2.5rem;
    transition: background 0.3s, color 0.3s;
  }
  .card {
    background: var(--card-bg);
    border-radius: 10px;
    padding: 1.8rem;
    margin-bottom: 1.8rem;
    box-shadow: 0 4px 12px rgba(0,0,0,.6);
  }
  h1 { margin-top: 0; color: var(--primary); font-size: 1.8rem; }
  .tag { background: var(--primary); color: #000; padding: .3rem .7rem; border-radius: 4px; font-size: 0.8rem; margin-left: .5rem; }
  .instructions {
    background: rgba(0, 255, 157, 0.1);
    border-left: 4px solid var(--primary);
    padding: 1rem;
    margin: 1.5rem 0;
    font-size: 1rem;
    line-height: 1.6;
  }
  .whitepaper-btn {
    display: inline-block;
    background: var(--live-bg);
    color: #000;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    font-size: 0.9rem;
    margin-top: 0.8rem;
    text-decoration: none;
    font-weight: bold;
  }
  .whitepaper-btn:hover { background: var(--primary-hover); color: #000; }
  label { display: block; margin-top: 1.2rem; font-weight: 600; }
  input, select {
    width: 100%;
    padding: .6rem;
    background: var(--input-bg);
    border: 1px solid var(--border);
    border-radius: 6px;
    color: var(--text);
    font-size: 1rem;
  }
  button {
    margin-top: 1.5rem;
    padding: .7rem 1.5rem;
    background: var(--primary);
    color: #000;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
    width: 100%;
  }
  button:hover { background: var(--primary-hover); }
  .preset-btn {
    background: var(--preset-bg);
    color: #fff;
    padding: .6rem 1rem;
    border-radius: 6px;
    font-size: 0.9rem;
    margin-top: 1rem;
    display: block;
    text-align: center;
    cursor: pointer;
    border: 0;
  }
  .live {
    background: #1a2a3a;
    color: #ffffff;
    padding: 1.2rem;
    border-radius: 10px;
    margin-top: 1.5rem;
    border-left: 4px solid #00ff9d;
    font-family: 'Courier New', monospace;
    font-size: 1rem;
  }
  [data-theme="light"] .live {
    background: #e6f7ff;
    color: #1a1a1d;
    border-left: 4px solid #00b368;
  }
  .live h3 { margin: 0 0 0.8rem; font-size: 1.1rem; color: #00ff9d; }
  [data-theme="light"] .live h3 { color: #00b368; }
  .live p { margin: 0.4rem 0; line-height: 1.5; }
  .highlight { color: var(--highlight); font-weight: bold; }
  .theme-toggle {
    position: fixed;
    top: 1rem;
    right: 1rem;
    background: var(--card-bg);
    border: 1px solid var(--border);
    padding: .5rem 1rem;
    border-radius: 50px;
    cursor: pointer;
    font-size: 1.2rem;
    box-shadow: 0 2px 8px rgba(0,0,0,.3);
  }
  .exchange-box, .input-box {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid var(--primary);
    border-radius: 8px;
    padding: 1rem;
    margin: 1.5rem 0;
    font-size: 0.95rem;
  }
  table { width: 100%; margin-top: 1rem; border-collapse: collapse; }
  th, td { border: 1px solid var(--border); padding: .6rem; text-align: left; font-size: 0.9rem; }
  th { background: var(--table-header); color: var(--table-header-text); font-weight: bold; }
  @media (max-width: 768px) {
    body { margin: 1rem; }
    .card { padding: 1.2rem; }
    h1 { font-size: 1.5rem; }
    table th, table td { padding: 0.4rem; font-size: 0.8rem; }
    .live { font-size: 0.9rem; }
    .theme-toggle { top: 0.5rem; right: 0.5rem; padding: 0.3rem 0.8rem; font-size: 1rem; }
  }
</style>
</head>
<body>
<div class="theme-toggle" onclick="toggleTheme()" title="Toggle Light/Dark Mode">Moon/Sun</div>
<div class="card">
  <h1>Watts > Wall Street <span class="tag">v9</span></h1>
  <p style="margin-top:0.5rem; font-size:0.9rem;">
    <a href="https://github.com/GrokkingGrok/Project-Asimov/blob/MVP/design/src/asimov/flow/WattsGreaterThanWallStreet.md" target="_blank" class="whitepaper-btn">
      Click here to read the Robonomics white paper: "Watts > Wall Street"
    </a>
  </p>
  <div class="instructions">
    <strong>See what your dividends would be as the dollar and RoboTorq go head to head in the marketplace.</strong><br>
    Follow steps to create a robotic worker economy → Hit Calculate → See your daily income grow as the RT gains market, and the exchange rate changes over time.
  </div>
  <!-- Starting Exchange Rate -->
  <div class="exchange-box">
    <label for="usdPerRT"><strong>Step 1: Set Starting Exchange Rate</strong></label>
    <div style="display:flex;gap:0.5rem;align-items:center;">
      <span style="white-space:nowrap;">1 RT =</span>
      <input id="usdPerRT" type="number" step="0.1" value="0.18" style="flex:1;">
      <span>USD</span>
    </div>
    <small>Default = U.S. electricity cost (~$0.18/kWh)</small>
  </div>
  <!-- Target Final Exchange Rate -->
  <div class="exchange-box">
    <label for="targetUsdPerRT"><strong>Step 2: Set Target Final Exchange Rate</strong></label>
    <div style="display:flex;gap:0.5rem;align-items:center;">
      <span style="white-space:nowrap;">1 RT =</span>
      <input id="targetUsdPerRT" type="number" step="0.1" value="10.0" style="flex:1;">
      <span>USD</span>
    </div>
    <small>Set your own policy here (e.g. $1, $10, $100, $1000), longer run times should have higher values</small>
  </div>
  <!-- Number of Contracts -->
  <div class="exchange-box">
    <label for="brlas"><strong>Step 3: Set Number of Robotic Labor Contracts</strong></label>
    <div style="display:flex;gap:0.5rem;align-items:center;">
      <input id="brlas" type="number" min="1" value="2000" step="1" style="flex:1;">
    </div>
    <small>How many Robotic Labor contracts (each contract = a bundle of robots)</small>
  </div>
  <!-- Robots per Contract -->
  <div class="exchange-box">
    <label for="robots"><strong>Step 4: Set Robots per Contract</strong></label>
    <div style="display:flex;gap:0.5rem;align-items:center;">
      <input id="robots" type="number" min="1" value="200" step="1" style="flex:1;">
    </div>
    <small>Robots that work under one contract (e.g. 200 = a small factory)</small>
  </div>
  <!-- Robot Power -->
  <div class="exchange-box">
    <label for="ttp"><strong>Step 5: Set Work Capacity in TTP (like robot horsepower)</strong></label>
    <div style="display:flex;gap:0.5rem;align-items:center;">
      <input id="ttp" type="number" step="0.1" value="150.0" style="flex:1;">
    </div>
    <small>Token-Torq per hour – think of it as robot “horsepower,” minimum of about 150</small>
  </div>
  <!-- Run Time -->
  <div class="exchange-box">
    <label for="runYears"><strong>Step 6: Set Run Time (Years) = Projection Horizon</strong></label>
    <div style="display:flex;gap:0.5rem;align-items:center;">
      <input id="runYears" type="number" min="1" value="5" step="1" style="flex:1;">
    </div>
    <small>How long the economy runs → also how many years to project your dividends</small>
  </div>
  <!-- Markup -->
  <div class="exchange-box">
    <label for="gamble"><strong>Step 7: Set Markup from Input Cost</strong></label>
    <div style="display:flex;gap:0.5rem;align-items:center;">
      <input id="gamble" type="number" step="0.1" min="1" value="50.0" style="flex:1;">
    </div>
    <small>Multiplier on robot "horsepower" to determine final selling price</small>
  </div>
  <!-- Items per Robot -->
  <div class="exchange-box">
    <label for="itemsPerRobot"><strong>Step 8: Set Items Made per Robot per Year</strong></label>
    <div style="display:flex;gap:0.5rem;align-items:center;">
      <input id="itemsPerRobot" type="number" step="1" value="100000" style="flex:1;">
    </div>
    <small>How many finished goods each robot produces annually (only used in CSV output)</small>
  </div>
  <!-- Population -->
  <div class="exchange-box">
    <label for="populationValue"><strong>Step 9: Set Population (and choose units from dropdown)</strong></label>
    <div style="display:flex;gap:0.5rem;align-items:center;">
      <input id="populationValue" type="number" value="350" step="1" style="flex:1;">
      <select id="populationUnit" style="flex:0.3;">
        <option value="1000000000">Billion</option>
        <option value="1000000" selected>Million</option>
        <option value="1000">Thousand</option>
      </select>
    </div>
    <small>Total citizens that share the minted RoboTorq (e.g. 350 Million)</small>
  </div>
  <!-- Initial Growth Rate -->
  <div class="exchange-box">
    <label for="initialGrowth"><strong>Step 10: Initial Annual Economy Growth Rate (%)</strong></label>
    <div style="display:flex;gap:0.5rem;align-items:center;">
      <input id="initialGrowth" type="number" step="1" value="20" min="0" style="flex:1;">
      <span>%</span>
    </div>
    <small>Economy starts growing at this rate/year; ramps down to 5% by final year. Assume very high growth when USD >> RoboTorq circulation (20%-80%+ not unreasonable)</small>
  </div>
  <button onclick="calc()" id="calcBtn">Calculate</button>
</div>
<div class="card" id="results" style="display:none">
  <h2>Your Dividend Over <span id="projYearsLabel">5</span> Years</h2>
  <div class="live">
    <h3>Today (Year 1)</h3>
    <p><strong>Daily Dividend:</strong> <span id="divPerDayRT" class="highlight">0</span> RT/day = <span id="divPerDayUSD" class="highlight">$0.00</span> USD/day</p>
  </div>
  <div class="live">
    <h3>Growth Projection</h3>
    <p><em>RT grows from $<span id="startRate">0.18</span> to $<span id="endRate">10.00</span> over <span id="yearsLabel">5</span> years</em></p>
    <table id="projTable"></table>
  </div>
  <button id="exportBtn" onclick="exportCSV()">Export CSV</button>
</div>
<script>
  const DEFAULT_USD_PER_KWH = 0.18;
  const HOURS_PER_YEAR = 8760;
  function toggleTheme() {
    const current = document.documentElement.getAttribute('data-theme') || 'dark';
    const next = current === 'dark' ? 'light' : 'dark';
    document.documentElement.setAttribute('data-theme', next);
    localStorage.setItem('roboTorqTheme', next);
  }
  if (localStorage.getItem('roboTorqTheme') === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
  }
  function resetResults() {
    document.getElementById('results').style.display = 'none';
    document.getElementById('divPerDayRT').textContent = '0';
    document.getElementById('divPerDayUSD').textContent = '$0.00';
    document.getElementById('projTable').innerHTML = '';
  }
  function calc() {
    resetResults();
    const brlas = parseFloat(document.getElementById('brlas').value) || 1;
    const robots = parseFloat(document.getElementById('robots').value) || 1;
    const ttp = parseFloat(document.getElementById('ttp').value) || 0;
    const runYears = parseFloat(document.getElementById('runYears').value) || 1;
    const gamble = parseFloat(document.getElementById('gamble').value) || 1;
    const itemsPerRobot = parseFloat(document.getElementById('itemsPerRobot').value) || 0;
    const popValue = parseFloat(document.getElementById('populationValue').value) || 0;
    const popUnit = parseFloat(document.getElementById('populationUnit').value) || 1;
    const population = popValue * popUnit;
    const startRate = parseFloat(document.getElementById('usdPerRT').value) || DEFAULT_USD_PER_KWH;
    const targetRate = parseFloat(document.getElementById('targetUsdPerRT').value) || startRate;
    const initialGrowth = parseFloat(document.getElementById('initialGrowth').value) || 0;
    if (brlas <= 0 || robots <= 0 || ttp <= 0 || runYears <= 0 || gamble <= 0 || itemsPerRobot <= 0 || population <= 0 || startRate <= 0 || targetRate <= 0) {
      alert("All values must be positive.");
      return;
    }
    const fleetTTP = ttp * brlas * robots;
    const baseRoboTorq_in = (fleetTTP * HOURS_PER_YEAR) / 1000;
    let currentMinted = baseRoboTorq_in * (gamble - 1);
    const mintedPerYear = [currentMinted]; // Year 1 base
    if (runYears > 1) {
      const numPeriods = runYears - 1;
      for (let period = 1; period <= numPeriods; period++) {
        const growth = initialGrowth - (initialGrowth - 5) * (period - 1) / (numPeriods - 1 || 1); // Ramp to 5%
        currentMinted *= (1 + growth / 100);
        mintedPerYear.push(currentMinted);
      }
    }
    document.getElementById('projYearsLabel').textContent = runYears;
    document.getElementById('yearsLabel').textContent = runYears;
    document.getElementById('startRate').textContent = startRate.toFixed(3);
    document.getElementById('endRate').textContent = targetRate.toFixed(2);
    const projTbl = document.getElementById('projTable');
    projTbl.innerHTML = '<tr><th>Year</th><th>RT Price</th><th>Daily Dividend</th></tr>';
    for (let year = 1; year <= runYears; year++) {
      let rate;
      if (runYears === 1) {
        rate = targetRate;
      } else {
        const cagr = Math.pow(targetRate / startRate, 1 / (runYears - 1)) - 1;
        rate = year === runYears ? targetRate : startRate * Math.pow(1 + cagr, year - 1);
      }
      const annualRT = mintedPerYear[year - 1] / population;
      const dailyRT = annualRT / 365;
      const dailyUSD = dailyRT * rate;
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${year}</td><td>$${rate.toFixed(3)}</td><td>$${dailyUSD.toFixed(4)}</td>`;
      projTbl.appendChild(tr);
      if (year === 1) {
        document.getElementById('divPerDayRT').textContent = dailyRT.toFixed(8);
        document.getElementById('divPerDayUSD').textContent = `$${dailyUSD.toFixed(4)}`;
      }
    }
    document.getElementById('results').style.display = 'block';
    document.getElementById('exportBtn').style.display = 'inline-block';
    document.querySelector('button[onclick="calc()"]').textContent = "Recalculate";
  }
  function exportCSV() {
    const runYears = parseInt(document.getElementById('runYears').value);
    const startRate = parseFloat(document.getElementById('usdPerRT').value);
    const targetRate = parseFloat(document.getElementById('targetUsdPerRT').value);
    // Recompute mintedPerYear as in calc() to avoid state issues
    const brlas = parseFloat(document.getElementById('brlas').value) || 1;
    const robots = parseFloat(document.getElementById('robots').value) || 1;
    const ttp = parseFloat(document.getElementById('ttp').value) || 0;
    const gamble = parseFloat(document.getElementById('gamble').value) || 1;
    const popValue = parseFloat(document.getElementById('populationValue').value) || 0;
    const popUnit = parseFloat(document.getElementById('populationUnit').value) || 1;
    const population = popValue * popUnit;
    const initialGrowth = parseFloat(document.getElementById('initialGrowth').value) || 0;
    const fleetTTP = ttp * brlas * robots;
    const baseRoboTorq_in = (fleetTTP * HOURS_PER_YEAR) / 1000;
    let currentMinted = baseRoboTorq_in * (gamble - 1);
    const mintedPerYear = [currentMinted];
    if (runYears > 1) {
      const numPeriods = runYears - 1;
      for (let period = 1; period <= numPeriods; period++) {
        const growth = initialGrowth - (initialGrowth - 5) * (period - 1) / (numPeriods - 1 || 1);
        currentMinted *= (1 + growth / 100);
        mintedPerYear.push(currentMinted);
      }
    }
    const rows = [["Year", "RT Price (USD)", "Daily Dividend (USD)"]];
    for (let year = 1; year <= runYears; year++) {
      let rate;
      if (runYears === 1) {
        rate = targetRate;
      } else {
        const cagr = Math.pow(targetRate / startRate, 1 / (runYears - 1)) - 1;
        rate = year === runYears ? targetRate : startRate * Math.pow(1 + cagr, year - 1);
      }
      const annualRT = mintedPerYear[year - 1] / population;
      const dailyRT = annualRT / 365;
      const dailyUSD = dailyRT * rate;
      rows.push([year, rate.toFixed(3), dailyUSD.toFixed(4)]);
    }
    const csv = rows.map(r => r.join(",")).join("\n");
    const blob = new Blob([csv], { type: 'text/csv' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = `dividend-${runYears}yrs-to$${targetRate}.csv`; a.click();
  }
  // Live update on every keystroke
  document.querySelectorAll('input, select').forEach(el => {
    el.addEventListener('input', () => calc());
  });
  // Init
  window.addEventListener('DOMContentLoaded', () => {
    const input = document.getElementById('usdPerRT');
    if (!input.value || parseFloat(input.value) <= 0) {
      input.value = DEFAULT_USD_PER_KWH.toFixed(3);
    }
  });
</script>
</body>
</html>
